<div id="flags_table">

  <% if flags.size == 0 %>
    <%=t('revs.flags.no_results')%>
  <% else %>

  <div class="row results-controls">
    <div class="col-md-4">
    </div>

    <div class="col-md-5 saved-item-pagination">
      <span >
        <%= page_entries_info flags, :entry_name=>'flag'%>
      </span>
    </div>
  </div>
  
    <table class="table table-bordered table-condensed table-hover table-striped">
      <tr>
        <% if local_assigns[:curate_view] %>
        <th><%= t('revs.curator.item_title') %></th>
         <th><%= t('revs.curator.flagging_user') %></th>
       <% end %>

        <% if not local_assigns[:curate_view] %>
          <th><%= t('revs.collection_members.items_name').titleize %></th>
        <% end%>

        <th><%= t('revs.flags.comment')%></th>

       <% if not local_assigns[:curate_view] %>
        <th><%= link_to t('revs.curator.flag_created'), user_flags_user_index_path(user.username, :order=>'created_at DESC', :selection=>local_assigns[:selection].join(',')) %></th>
       <% end %>

       <% if local_assigns[:curate_view] %>
        <th><%= link_to t('revs.curator.flag_created'), flags_table_curator_tasks_path(:order=>'created_at DESC', :selection=>local_assigns[:selection].join(','), :tab=>@tab_list_flag)%></th>
       <% end %>


        <th><%= t('revs.messagaes.status') %></th>

        <% if Flag.display_resolved_columns(local_assigns[:selection])%>
          <th><%= t('revs.curator.resolver_username') %></th>
          <th><%= t('revs.curator.resolution_notes') %></th>
          <% if local_assigns[:curate_view]%>
            <th><%= t('revs.curator.resolution_date')%></th>
          <% end%>
        <% end %>
      </tr>

      <% flags.each do |flag| %>
       <tr>
         <td><%= item_link(flag.solr_document,:truncate=>true, :target => (local_assigns[:curate_view] ? '_blank' : '')) %></td>
         <% if local_assigns[:curate_view]%>
           <td><%=flag.user.nil? ? (flag.private_comment.blank? ? t('revs.user.anonymous') : simple_format(flag.private_comment.strip)) : display_user_name(flag.user,user_flags_user_index_path(flag.user.username))%></td>
         <% end%>
        <td><%= flag.comment %>
        </td>
        <td><%= show_as_datetime(flag.created_at.in_time_zone) %></td>
        <td><%= flag.state_display_name%></td>
       <% if Flag.display_resolved_columns(local_assigns[:selection])%>
        <td>
          <% if flag.resolved? && !flag.resolved_by.blank? %>
            <%= flag.resolved_by.to_s%>
          <%end%>
        </td>
        <td><%= flag.resolution%></td>
        <% if local_assigns[:curate_view] %>
          <td>
            <% if flag.resolved_time != nil %>
              <%= show_as_datetime(flag.resolved_time.in_time_zone)%>
            <% end %>
          </td>
        <% end %>
       <% end %>
       </tr>
      <% end %>

    </table>

  <% end %>

  <% if not local_assigns[:curate_view] %>   
     <%= paginate flags, :param_name => :pagina, :params => {:controller => 'user', :action => 'flags',:id=>user.username } %>
  <% end %>

  <% if local_assigns[:curate_view] %>   
     <%= paginate flags, :param_name => :pagina, :params => {:controller => 'curator/tasks', :action => 'flags'} %>
  <% end %>
  
</div>